# TIL for 2024-11-21
## 11/19 & 20 やったこと！
- ミニかどうか分からなくなってきたアプリの続き

---

### - 11/19
今日書くとか言ってたのにやったこと忘れたのでtwitter見に行ったら完璧に思い出しました。こいつなんかあったらすぐツイートするやん・・・<br>

#### - Railsのバージョンダウン
Rails newしたときにバージョン指定方法分からんくて8.0になってしまって、「まぁ勉強になるかもしれんしええか」と思って放置してたんですよね<br>
その後デプロイ深掘りしてたらバージョン指定方法分かったんですけどめんどくさかったので放置してましたｗ（先週の火曜）<br>

ストロングパラメータの書き方変わってたりぐらいしか分からなかったんですが一応勉強になったのかなと思ってたら、tiwtterで[なかyarnさん](https://chat.runteq.jp/runteq/channels/times49b_takenaka_eri)が
Railsのバージョンのことつぶやいてたりそれに校長が反応してたりしてて、それ読んでみるとあんまりよくないんかなと思ったんでRailsのバージョンダウンしました<br>

https://zenn.dev/norihashimo/articles/523032109ff4d2<br>
この手順でやったら無事バージョンダウン出来ました。<br>

マイグレーションファイルにもRailsのバージョンみたいなの書いてあってエラー吐いたんでそれも書き換えときました<br>

#### - Ruansack4.0以降のエラー対処と使い方
カリキュラムでやったしggezやろとか思ってたら速攻エラー吐いて泡拭いて倒れました。嘘です。
検索対象の許可リストみたいなの書かなあかんらしい、引っかかってほしくないものもあるからね。そりゃそうや<br>
https://qiita.com/Yamashita-Taiki/items/764be62a8c20485ece54<br>

適当に書いてプルダウン使った検索フォームも実装しました<br>
https://qiita.com/mmaumtjgj/items/8731a70b3f328770867c<br>
https://qiita.com/AKI3/items/0a47f9536413b4436389<br>

#### - エラー画面の出ないクソエラーその２
押したらアクションが走って渡したインスタンスの情報が更新される。みたいな”リンク”を実装したらちょっと思わぬ挙動をしてたせいで理解できずに頭抱えてました<br>
因みにフォームのボタンではないです<br>

やりたかったことは<br>
```
<%= link_to "何が出るかな！？" , letter_path(@letters.random) %>
```
みたいなリンク作ってリンクが押されるたびに@lettersの中から一つランダムにletterのインスタンス持ってきてそいつのshowアクションに飛ばす<br>
って感じのことでした<br>

↑には書いてませんがポップアップで別window開いてその結果表示してたんですがそうすると親window(リンクが実際においてあるページ)がリロードされません<br>

それの何がいけないかって言うと、僕はリンクが押されるたびに@letters.ramdomが評価されて宛先が決まると思ってたんですが<br>
どうやら初めに画面が読み込まれてリンクが作成される時の一度だけ@letters.randomが評価されて、その後そのリンクは画面が再度読み込みされない限りそのletterへのshowリンクであり続けるようで<br>
何度このリンク押しても同じletterが表示されてしまうのです。<br>

ＪＳ使ってポップアップ出して数秒待って親ウィンドウリロードとか<br>
ＪＳ使って一つのボタンを押したらポップアップでletterが表示されて、その処理が終わるとウィンドウをリロードする<br>
とかいろいろやったんですけどなんかうまくいかず挙動も微妙やったので<br>

@lettersを決める要素だけリンクでアクションに送る　→　アクションで@lettersを特定　→　@letters.randomを実行　→　@letter表示<br>
ってするといい感じに動きました。<br>

ポップアップしてるのに連続でランダム抽出したい場合にポップアップしたwindowにリンクが無くて不便だったのですが、抽出する前の@lettersを引っ張ってきたり渡したりってのが微妙にどうやるか分からんくて<br>
一緒に悩んでたんですけどそれもアクションに特定する要素だけ渡すって方法をとることで解決しました。<br>

#### - エラー画面の出ないクソエラーその3
さっきのリンクで通るアクションの中でそのインスタンスのカラム内容を強制的に書き換える処理があったんですが、なぜかリンクを一回押しただけで２回もその処理が走ってしまってるようでした<br>
なんででござるか！？とか言いながらコントローラーのメソッドとかアクションとか調べたけど分からず<br>
「なんで二回飛んでんねん」とか思ってログ見ながら画面弄ってたら、まさかの**リンクにホバーしただけでアクション実行されてました。**

ナニコレきっしょ・・・とか思いながら<br>
https://techracho.bpsinc.jp/hachi8833/2024_09_25/143750<br>
この記事見ながらそのリンクだけ「プリフェッチ」止めときました<br>

#### - [ディングー神](https://chat.runteq.jp/runteq/channels/times_47b_mitsuhashi_daisuke)と[ゆーか](https://chat.runteq.jp/runteq/channels/times_53b_ishii_yuuka)さんとおしゃべり
風呂あがったら前から話してみたかったゆーかさんと、いつも仲良くさせてもらってるディングー神が二人でしゃべってたので突撃しました<br>
「お話したかったんすよ」みたいに言われたんでまた心で泣きながら喜んでました<br>
あと「まっさんいいっすよ」って吹聴してるの誰ですか？割といろんなとこから聞くんですけど？？なにそのガジェットおすすめするみたいなやつ？？？<br>
嬉しいからもっと俺のこと**直接**褒めて？？？<br>

ゆーかさんは僕が大好きなゲームやってらっしゃったので面白い話がいろいろ出来ました、よかった・・・<br>
ディングー神には素晴らしき叡智を授けていただきました。おかげでアプリが一気に完成に近づいたのと次の目標が決まりました。<br>

やっぱつええひとと”質問とかじゃなく対等に”話せるのっていいなって思いました。<br>
よっかかってくだけじゃなく俺も何か彼ら彼女らに返せるように精進していこうと固く心に誓ったのでした。<br>

---

### - 11/20

#### - 週一面談
週一の面談行ってきました。<br>
ディングー神の叡智のおかげでアプリが結構 :iikanji: になってきたのでキャリコンの人に見せました<br>
ですが普通に目の前でバリデーションエラー吐いてめっちゃ恥ずかしかったです。///（コントローラー記述ミス）<br>
テスト書いてたらキャッチできてそうなバグだったのでテストコード大事やなぁって思いました
今回は時間無いから省いたけど次何か作るときはテスト書くぞ！<br>

#### - アプリ続き
ディングー神の叡智をもとにいろいろいじってたらめっちゃアプリがそれっぽくなったので３～４人ぐらいに触ってもらいました（デバックさせてたｗ）<br>
割と感触の良い反応が返ってきたのでほぼこれで完成ですね<br>

本腰入れてアプリ作りだしたのが先週の水曜からやと考えると大体１週間ぐらいで完成したので、これぐらいの機能、テーブル数、こだわりでこの期間で作れるって言う良いモデルケースにできました。<br>
思ったより時間がかかったとこ、思ったよりかからなかったとこあってそういうのはとても勉強になりました。<br>

後はいくつか最低限必要そうな機能を追加するのとバグ潰しです<br>

重要なものの実装が終わってそのほかに関係する準備ができたら皆さんにもすぐに披露できると思います<br>

---

[Qiita Advent Calender 2024](https://qiita.com/advent-calendar/2024/runteq)はマジでいろいろ都合が良いので今回のアプリのことにしようと思います！<br>
余裕があればDockerでの環境構築からデプロイ（RenderにDockerを使って上げる）ってやつも追加するか別で書こうかなと思ってます<br>

やっぱりプログラミング楽しいですね、作ってる時とか見た目整ってない時は「こんなんつくっても・・・」とか「こんなんしか作れんのか・・・」って自身なくしてましたが<br>
”ガワ”ができるとなんかそれっぽくなって急に自信取り戻せたんでよかったですｗｗ　でぃんぐー神ありがと・・・<br>

今まで学んだことを結構使ったり、問題解決のフローとか、RailsとかDockerへの理解とかが深まるなどめっちゃ勉強になったので今すげぇ充実してて楽しいです<br>
明日もアプリ完成に向けて頑張ります、おやすみなさい！<br>

---

追記：いつもtimes書いた後GitHubの草はやしの為にtilリポジトリに丸々コピペしてpushするんですが日付入力がめんどくさくて・・・ｗ<br>

良い方法見つけたので共有しときます<br>
https://qiita.com/umyu/items/d9c3875133b8d1c6cb20
